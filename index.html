<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tombola Python - Multiplayer Realtime</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-screen">
        <div class="container">
            <div class="login-card">
                <div class="logo">
                    <h1><span class="python">Python</span> Tombola</h1>
                    <p class="subtitle">Sistema multiplayer in tempo reale</p>
                </div>

                <!-- Player Login -->
                <div id="player-login">
                    <div class="form-group">
                        <label class="form-label">Codice Giocatore</label>
                        <input type="text" class="form-input" id="player-code" placeholder="PLAYER001, PLAYER002, ...">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Nome Giocatore</label>
                        <input type="text" class="form-input" id="player-name" placeholder="Il tuo nome">
                    </div>
                    
                    <button class="btn btn-primary" id="player-login-btn" style="width: 100%;">
                        <i class="fas fa-sign-in-alt"></i> Accedi come Giocatore
                    </button>
                    
                    <div class="divider">
                        <span>Oppure</span>
                    </div>
                    
                    <button class="btn btn-secondary" id="admin-switch" style="width: 100%;">
                        <i class="fas fa-user-shield"></i> Sono l'Amministratore
                    </button>
                </div>

                <!-- Admin Login -->
                <div id="admin-login" style="display: none;">
                    <div class="form-group">
                        <label class="form-label">Codice Admin</label>
                        <input type="password" class="form-input" id="admin-code" placeholder="Inserisci il codice admin">
                        <small style="color: var(--text-secondary); margin-top: 5px; display: block;">
                            Codice predefinito: PYTHON2024_ADMIN
                        </small>
                    </div>
                    
                    <button class="btn btn-warning" id="admin-login-btn" style="width: 100%;">
                        <i class="fas fa-user-cog"></i> Accedi come Admin
                    </button>
                    
                    <button class="btn btn-secondary" id="player-switch" style="width: 100%; margin-top: 15px;">
                        <i class="fas fa-user"></i> Sono un Giocatore
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Game Screen -->
    <div class="game-screen">
        <div class="container">
            <!-- Header -->
            <div class="header">
                <div class="user-info">
                    <div class="user-details">
                        <div class="user-avatar">
                            <i class="fas fa-user" id="user-icon"></i>
                        </div>
                        <div class="user-text">
                            <h3 id="user-name">-</h3>
                            <span class="user-role" id="user-role">-</span>
                        </div>
                    </div>
                    
                    <button class="btn btn-danger" id="logout-btn">
                        <i class="fas fa-sign-out-alt"></i> Esci
                    </button>
                </div>
                
                <div class="status-grid">
                    <div class="status-card">
                        <div class="status-value" id="numbers-left">90</div>
                        <div class="status-label">Numeri Rimasti</div>
                    </div>
                    
                    <div class="status-card">
                        <div class="status-value" id="extracted-count">0</div>
                        <div class="status-label">Numeri Estratti</div>
                    </div>
                    
                    <div class="status-card">
                        <div class="status-value" id="players-count">0</div>
                        <div class="status-label">Giocatori Online</div>
                    </div>
                    
                    <div class="status-card">
                        <div class="status-value" id="current-turn">-</div>
                        <div class="status-label">Turno Attuale</div>
                    </div>
                </div>
            </div>

            <!-- Game Area -->
            <div class="game-area">
                <!-- Left Column: Game Control -->
                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-dice"></i> Estrazione Numeri
                    </h2>
                    
                    <div class="number-display">
                        <div id="no-number">
                            <i class="fas fa-hourglass-half" style="font-size: 4rem; color: var(--text-secondary); margin-bottom: 20px;"></i>
                            <div style="color: var(--text-secondary); font-size: 1.2rem;">
                                In attesa del primo numero...
                            </div>
                        </div>
                        <div id="current-number" style="display: none;">
                            <div class="current-number" id="current-number-value">-</div>
                            <div class="number-label">Ultimo numero estratto</div>
                        </div>
                    </div>

                    <!-- Admin Controls -->
                    <div id="admin-controls" style="display: none;">
                        <div class="admin-panel">
                            <h3 class="admin-title">
                                <i class="fas fa-user-cog"></i> Controlli Amministratore
                            </h3>
                            
                            <div class="controls">
                                <button class="btn btn-primary" id="extract-btn">
                                    <i class="fas fa-play"></i> Estrai Numero
                                </button>
                                
                                <button class="btn btn-success" id="auto-btn">
                                    <i class="fas fa-robot"></i> Auto Estr.
                                </button>
                                
                                <button class="btn btn-warning" id="new-game-btn">
                                    <i class="fas fa-redo"></i> Nuova Partita
                                </button>
                                
                                <button class="btn btn-secondary" id="manage-codes-btn">
                                    <i class="fas fa-key"></i> Gestisci Codici
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Player Message -->
                    <div id="player-message" style="display: none; text-align: center; padding: 20px; color: var(--text-secondary);">
                        <i class="fas fa-info-circle"></i> In attesa che l'amministratore estragga i numeri...
                    </div>

                    <!-- Extracted Numbers -->
                    <h3 class="card-title" style="margin-top: 30px;">
                        <i class="fas fa-history"></i> Ultimi Numeri Estratti
                    </h3>
                    <div class="extracted-numbers" id="extracted-numbers">
                        <!-- Numbers will appear here -->
                    </div>
                </div>

                <!-- Right Column: Player Board -->
                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-table"></i> La tua Cartella
                    </h2>
                    
                    <div class="tombola-section">
                        <div class="tombola-grid" id="tombola-grid">
                            <!-- Tombola grid will be generated here -->
                        </div>
                    </div>

                    <div class="players-section">
                        <h3 class="card-title">
                            <i class="fas fa-users"></i> Giocatori Online
                        </h3>
                        <div class="players-list" id="players-list">
                            <!-- Players will appear here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    
    <!-- Winner Modal -->
    <div class="modal-overlay" id="winner-modal-overlay">
        <div class="modal">
            <h2 class="modal-title">ðŸŽ‰ TOMBOLA! ðŸŽ‰</h2>
            <div class="modal-content">
                <p style="text-align: center; font-size: 1.2rem;">
                    <strong id="winner-name">-</strong> ha completato la cartella e ha vinto la partita!
                </p>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="close-winner-modal">
                    Continua a giocare
                </button>
                <button class="btn btn-primary" id="new-game-modal-btn">
                    Nuova Partita
                </button>
            </div>
        </div>
    </div>

    <!-- Codes Modal -->
    <div class="modal-overlay" id="codes-modal-overlay">
        <div class="modal">
            <h2 class="modal-title">
                <i class="fas fa-key"></i> Gestione Codici
            </h2>
            <div class="modal-content">
                <div style="margin-bottom: 20px;">
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <input type="number" class="form-input" id="codes-count" min="1" max="50" value="5" style="flex: 1;">
                        <button class="btn btn-warning" id="generate-codes-btn">
                            <i class="fas fa-plus"></i> Genera Codici
                        </button>
                    </div>
                </div>
                
                <div class="codes-list" id="codes-list">
                    <!-- Codes will appear here -->
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="close-codes-modal">
                    Chiudi
                </button>
                <button class="btn btn-primary" id="copy-codes-btn">
                    <i class="fas fa-copy"></i> Copia Codici
                </button>
            </div>
        </div>
    </div>

    <!-- Generated Codes Modal -->
    <div class="modal-overlay" id="generated-codes-modal-overlay">
        <div class="modal">
            <h2 class="modal-title">
                <i class="fas fa-key"></i> Codici Generati
            </h2>
            <div class="modal-content">
                <p style="margin-bottom: 15px;">Ecco i nuovi codici generati. Condividili con i giocatori:</p>
                <div id="generated-codes" style="
                    background: rgba(0, 0, 0, 0.2);
                    padding: 15px;
                    border-radius: 8px;
                    font-family: monospace;
                    max-height: 200px;
                    overflow-y: auto;
                ">
                    <!-- Generated codes will appear here -->
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" onclick="document.getElementById('generated-codes-modal-overlay').style.display = 'none'">
                    Chiudi
                </button>
            </div>
        </div>
    </div>

    <!-- Connection Status -->
    <div class="connection-status">
        <div class="connection-dot" id="connection-dot"></div>
        <span id="connection-text">Connessione...</span>
    </div>

    <script src="game.js"></script>
</body>
</html>
